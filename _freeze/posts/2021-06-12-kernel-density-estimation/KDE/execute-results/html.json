{
  "hash": "05b2ac6205b9eec3c25bfbd806e184f4",
  "result": {
    "markdown": "---\ntitle: \"kernel density estimation\"\ndescription: |\n  kernel density estimation <ec><86><8c><ea><b0><9c>\nauthor: \"Don Don\"\ndate: \"2021-06-22\"\ncategories: [python]\nimage: \"https://upload.wikimedia.org/wikipedia/commons/thumb/4/47/Kernels.svg/500px-Kernels.svg.png\"\n---\n\n\n# Probability density function\n\n<ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98>(pdf)<eb><8a><94> <ed><99><95><eb><a5><a0><eb><b3><80><ec><88><98><ec><9d><98> <eb><b6><84><ed><8f><ac><eb><a5><bc> <eb><82><98><ed><83><80><eb><82><b4><eb><8a><94> <ed><95><a8><ec><88><98><eb><a1><9c> <eb><b3><b4><ed><86><b5> <ed><99><95><eb><a5><a0><eb><b3><80><ec><88><98><ea><b0><80> <ec><97><b0><ec><86><8d><ed><98><95><ec><9d><bc> <eb><95><8c><eb><a5><bc> <ec><a7><80><ec><b9><ad><ed><95><9c><eb><8b><a4>.\n<ed><99><95><eb><a5><a0> <eb><b0><80><eb><8f><84> <ed><95><a8><ec><88><98><eb><8a><94> <eb><91><90> <ea><b0><80><ec><a7><80> <ec><a1><b0><ea><b1><b4><ec><9d><84> <eb><a7><8c><ec><a1><b1><ed><95><b4><ec><95><bc> <ed><95><9c><eb><8b><a4>.\n\n-   <eb><aa><a8><eb><93><a0> <ec><8b><a4><ec><88><98><ea><b0><92> x<ec><97><90> <eb><8c><80><ed><95><b4> $f(x)\\ge 0$\n\n-   $\\int_{-\\infty}^{\\infty} f(x) dx$=1\n\npdf <ec><a1><b0><ea><b1><b4><ec><97><90><ec><84><9c> <ec><95><8c> <ec><88><98> <ec><9e><88><eb><93><af><ec><9d><b4> <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98><eb><8a><94> <ed><99><95><eb><a5><a0><ec><9d><b4> <ec><95><84><eb><8b><88><eb><a9><b0>, <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98><eb><a5><bc> <ec><a0><81><eb><b6><84><ed><95><b4><ec><95><bc><eb><a7><8c> <ed><99><95><eb><a5><a0><ec><9d><b4> <eb><82><98><ec><98><a8><eb><8b><a4>.\n\n# Probability density\n\n<ed><99><95><eb><a5><a0> <eb><b0><80><eb><8f><84><eb><8a><94> $X=x_0$<ec><9d><bc> <eb><95><8c> <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98>($f(x_0)$)<ea><b0><92><ec><9d><84> <ec><9d><98><eb><af><b8><ed><95><9c><eb><8b><a4>.\n<eb><94><b0><eb><9d><bc><ec><84><9c> <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98><eb><8a><94> <eb><b6><84><ed><8f><ac><ec><9d><98> <ed><98><95><ed><83><9c><eb><a5><bc> <ec><96><b4><eb><96><bb><ea><b2><8c> <ec><a0><95><ec><9d><98><ed><95><98><eb><8a><94><ec><a7><80><ec><97><90> <eb><94><b0><eb><9d><bc> <ec><96><bc><eb><a7><88><eb><93><a0><ec><a7><80> 1 <ec><9d><b4><ec><83><81><ec><9d><98> <ea><b0><92><ec><9d><b4> <eb><82><98><ec><98><ac> <ec><88><98> <ec><9e><88><eb><8b><a4>.\n<ec><98><88><eb><a5><bc> <eb><93><a4><ec><96><b4> <ec><a0><95><ea><b7><9c><eb><b6><84><ed><8f><ac><ec><9d><98> <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98> <ec><8b><9d><ec><97><90> <ed><8a><b9><ec><a0><95> <ea><b0><92><ec><9d><84> <eb><8c><80><ec><9e><85><ed><96><88><ec><9d><84> <eb><95><8c> <eb><82><98><ec><98><a4><eb><8a><94> <ea><b0><92>(y<ec><b6><95> <ea><b0><92>)<ec><9d><84> <ec><83><9d><ea><b0><81><ed><95><b4><eb><b3><b4><eb><a9><b4> <ec><96><bc><eb><a7><88><eb><93><a0><ec><a7><80> 1 <ec><9d><b4><ec><83><81><ec><9d><98> <ea><b0><92><ec><9d><b4> <eb><82><98><ec><98><ac> <ec><88><98> <ec><9e><88><eb><8b><a4>.\n\n<ec><97><b0><ec><86><8d><ed><98><95> <ed><99><95><eb><a5><a0> <eb><b3><80><ec><88><98> $X$<eb><a5><bc> <ec><a0><95><ec><9d><98><ed><96><88><ec><9d><84> <eb><95><8c> $P(X=x_0)$<ec><9d><80> <ec><97><b0><ec><86><8d> <ea><b5><ac><ea><b0><84><ec><97><90><ec><84><9c><eb><8a><94> <ec><b7><a8><ed><95><a0> <ec><88><98> <ec><9e><88><eb><8a><94> <eb><ac><b4><ec><88><98><ed><9e><88> <eb><a7><8e><ec><9d><80> <ea><b2><bd><ec><9a><b0><ec><9d><98> <ec><88><98><ea><b0><80> <ec><9e><88><ec><9c><bc><eb><af><80><eb><a1><9c> $P(X=x_0)=0$<ec><9d><b4><eb><8b><a4>.\n\n<eb><a7><8c><ec><95><bd> $X$<ec><9d><98> <eb><b2><94><ec><9c><84><ea><b0><80> a<ec><99><80> b <ec><82><ac><ec><9d><b4><ec><97><90><ec><84><9c> <ec><a0><95><ec><9d><98><eb><90><98><eb><a9><b4> <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98><ec><9d><98> <ec><a0><95><ec><9d><98><ec><97><90> <eb><94><b0><eb><9d><bc><ec><84><9c> $P(a\\le X \\le b)$ = 1<ec><9d><84> <eb><a7><8c><ec><a1><b1><ed><95><b4><ec><95><bc> <ed><95><9c><eb><8b><a4>.\n<ec><9d><b4> <eb><95><8c> <eb><91><90> <ea><b0><80><ec><a7><80> <eb><aa><a8><ec><88><9c><ec><9d><b4> <ec><a1><b4><ec><9e><ac><ed><95><9c><eb><8b><a4>.\n$P(X=x_0)=0$<ec><9c><bc><eb><a1><9c> <ec><a0><95><ec><9d><98><ed><95><98><eb><a9><b4> $X$<ec><9d><98> <eb><b2><94><ec><9c><84> a<ec><99><80> b <ec><82><ac><ec><9d><b4><ec><97><90><ec><84><9c> $P(X=x_0)$<eb><ac><b4><ec><88><98><ed><9e><88> <eb><a7><8e><ec><9d><b4> <eb><8d><94><ed><95><b4><eb><8f><84> 1<ec><9d><84> <eb><a7><8c><ec><a1><b1><ed><95><98><ec><a7><80> <ec><95><8a><eb><8a><94><eb><8b><a4>.\n$P(X=x_0)=\\epsilon$, <ec><a6><89> 0<ec><97><90> <ec><95><84><ec><a3><bc> <ea><b7><bc><ec><a0><91><ed><95><9c> <eb><a7><a4><ec><9a><b0> <ec><9e><91><ec><9d><80> <ea><b0><92><ec><9c><bc><eb><a1><9c> <ec><a0><95><ec><9d><98><ed><95><98><eb><a9><b4> <ec><97><b0><ec><86><8d> <ea><b5><ac><ea><b0><84><ec><97><90><ec><84><9c><eb><8a><94> <ec><b7><a8><ed><95><a0> <ec><88><98> <ec><9e><88><eb><8a><94> <eb><ac><b4><ec><88><98><ed><9e><88> <eb><a7><8e><ec><9d><80> <ea><b2><bd><ec><9a><b0><ec><9d><98> <ec><88><98><ea><b0><80> <ec><9e><88><ec><9c><bc><eb><af><80><eb><a1><9c> $P(a\\le X \\le b)=\\infty$<ea><b0><80> <eb><90><9c><eb><8b><a4>.\n\n<eb><94><b0><eb><9d><bc><ec><84><9c> $P(X=x_0)$<ec><9d><80> <ec><9c><84><ec><9d><98> <ec><a0><95><ec><9d><98><eb><a5><bc> <ea><b7><b8><eb><8c><80><eb><a1><9c> <ec><83><9d><ea><b0><81><ed><95><b4><eb><b3><b4><eb><a9><b4> 0<ec><9d><80> <ec><95><84><eb><8b><88><ec><a7><80><eb><a7><8c> 0<eb><b3><b4><eb><8b><a4> <ec><9e><91><ec><9d><80> <ea><b0><92><eb><8f><84> <ec><95><84><eb><8b><8c> <ea><b0><92>?<ec><9d><b4>\n<eb><90><9c><eb><8b><a4>.\n\n<eb><8b><a4><ec><8b><9c> <ec><b2><98><ec><9d><8c> <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98><ec><9d><98> <ec><a0><95><ec><9d><98><ec><97><90><ec><84><9c> <ec><b6><9c><eb><b0><9c><ed><95><98><eb><a9><b4> <ed><99><95><eb><a5><a0> <eb><b3><80><ec><88><98> $X$<ec><9d><98> <eb><b2><94><ec><9c><84><ea><b0><80> 0<eb><b6><80><ed><84><b0> 1<ea><b9><8c><ec><a7><80><eb><9d><bc><ea><b3><a0> <ed><96><88><ec><9d><84> <eb><95><8c> $P(0\\le X \\le 1)$ = 1<ec><9d><b4><eb><8b><a4>.\n<ea><b5><ac><ea><b0><84><ec><9d><84> <ec><a0><88><eb><b0><98><ec><9c><bc><eb><a1><9c> <eb><82><98><eb><88><84><eb><a9><b4> $P(0\\le X \\le \\frac{1}{2})=\\frac{1}{2}$<ec><9d><b4><eb><8b><a4>.\n<ea><b5><ac><ea><b0><84><ec><9d><84> <eb><8b><a4><ec><8b><9c> <ec><a0><88><eb><b0><98><ec><9c><bc><eb><a1><9c> <eb><82><98><eb><88><84><eb><a9><b4> $P(0\\le X \\le \\frac{1}{4})=\\frac{1}{4}$<ec><9d><b4><eb><8b><a4>.\n<ec><9d><b4><eb><9f><ac><ed><95><9c> <ea><b3><bc><ec><a0><95><ec><9d><84> <ea><b3><84><ec><86><8d> <eb><b0><98><eb><b3><b5><ed><95><b4><ec><84><9c> <ea><b5><ac><ea><b0><84><ec><9d><84> <ec><9e><98><ea><b2><8c> <ec><aa><bc><ea><b0><9c><eb><a9><b4> $P(0\\le X \\le d)=d$<ea><b0><80> <ec><84><b1><eb><a6><bd><ed><95><98><eb><a9><b0>, $P(x_0\\le X \\le x_0+d)=d$<ec><9d><b4><eb><8b><a4>.\n<ec><a6><89>, $P(X=x_0)=\\lim_{d\\to+0} P(x_0 \\le X \\le x_0+d)$<ec><9d><b4><eb><a9><b0>, <ec><8b><9d><ec><97><90> <eb><94><b0><eb><9d><bc> $P(X=x_0)=0$<ec><9d><b4> <eb><90><9c><eb><8b><a4>.\n\n<ec><9d><b4> <ec><a0><95><ec><9d><98><eb><8f><84> <eb><ac><b8><ec><a0><9c><ea><b0><80> <ec><9e><88><eb><8a><94><eb><8d><b0> <ec><a0><95><ec><9d><98> <ea><b7><b8><eb><8c><80><eb><a1><9c> $P(X=x_0)=0$<ec><9d><b4><eb><a9><b4> a<ec><9d><98> <ea><b0><92><ec><97><90> <ec><83><81><ea><b4><80><ec><97><86><ec><9d><b4> $P(0 \\le X \\le a)=0$<ec><9d><b4> <eb><90><9c><eb><8b><a4>.\n<ec><9d><b4> <eb><ac><b8><ec><a0><9c><eb><a5><bc> <ed><95><b4><ea><b2><b0><ed><95><98><ea><b8><b0> <ec><9c><84><ed><95><b4><ec><84><9c> $P(x_0\\le X \\le x_0+d)=d$d<ec><97><90><ec><84><9c> <ec><96><91><eb><b3><80><ec><97><90> d<eb><a5><bc> <eb><82><98><eb><88><a0><ec><84><9c> <ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><eb><a5><bc> <ec><9e><ac><ec><a0><95><ec><9d><98><ed><95><98><eb><a9><b4> <eb><8b><a4><ec><9d><8c><ea><b3><bc> <ea><b0><99><eb><8b><a4>.\n\n\n$$\n\\begin{align}\nf(x_0) &= P(X=x_0) \\newline\n&=\\lim_{d\\to+0} \\frac{P(x_0 \\le X \\le x_0+d)}{d} \\newline \n&= \\lim_{d\\to+0} \\frac{P(x_0 \\le X \\le x_0+d)}{d} \\newline\n&=lim_{d\\to+0}\\frac{d}{d} \\newline\n&=lim_{d\\to+0} 1 = 1\n\\end{align}\n$$\n\n\n# Density estimation <ec><9d><98><eb><af><b8>\n\n<ed><86><b5><ea><b3><84><ed><95><99><ec><97><90><ec><84><9c> density estimation<ec><9d><80> <eb><b3><b4><ed><86><b5> <eb><b6><84><ed><8f><ac>(<ed><99><95><eb><a5><a0><eb><b0><80><eb><8f><84><ed><95><a8><ec><88><98>)<ec><9d><98> <ed><98><95><ed><83><9c><eb><a5><bc> <ea><b0><80><ec><a0><95><ed><95><98><ea><b3><a0> <eb><8d><b0><ec><9d><b4><ed><84><b0><eb><a5><bc> <ec><9d><b4><ec><9a><a9><ed><95><b4><ec><84><9c> <eb><aa><a8><ec><88><98><eb><a5><bc> <ec><b6><94><ec><a0><95><ed><95><98><eb><8a><94> <eb><b0><a9><ec><8b><9d><ec><9d><b4><eb><8b><a4>.(parametric density estimation<ec><9d><b4><eb><9d><bc><ea><b3><a0><eb><8f><84> <ed><95><9c><eb><8b><a4>)\n\n<eb><b0><98><eb><a9><b4><ec><97><90> kernel density estimation<ec><97><90><ec><84><9c><eb><8a><94> <eb><b6><84><ed><8f><ac><ec><9d><98> <ed><98><95><ed><83><9c><eb><a5><bc> <ea><b0><80><ec><a0><95><ed><95><98><ec><a7><80> <ec><95><8a><ea><b3><a0> <ea><b4><80><ec><b0><b0><eb><90><9c> <eb><8d><b0><ec><9d><b4><ed><84><b0><eb><a7><8c><ec><9d><84> <ec><9d><b4><ec><9a><a9><ed><95><b4><ec><84><9c> <eb><b6><84><ed><8f><ac><eb><a5><bc> <ec><b6><94><ec><a0><95><ed><95><9c><eb><8b><a4>.\n(non-parametric density estimation<ec><9d><b4><eb><9d><bc><ea><b3><a0><eb><8f><84> <ed><95><9c><eb><8b><a4>)\n\n# Kernel density <ec><a0><95><ec><9d><98>\n\n$\\hat{f(x)} = \\frac{1}{n}\\sum_{i=1}^n w(\\frac{x-X_i}{h})$\n\n$h$ : bin width or smoothing parameter or window width\n\n<ea><b0><84><ea><b2><a9><ec><9d><84> <ec><a2><81><ea><b2><8c> <ed><95><98><eb><a9><b4> undersmooth<eb><90><98><ea><b3><a0>, <eb><b0><98><eb><a9><b4><ec><97><90> <ea><b0><84><ea><b2><a9><ec><9d><84> <eb><84><93><ea><b2><8c> <ed><95><98><eb><a9><b4> oversmooth<eb><90><9c><eb><8b><a4>.\n\n$w$ : weight function (=$K(\\cdot)$ : kernel function) $w(t)$<eb><8a><94> probability density<ec><9d><98> <ec><84><b1><ec><a7><88><ec><9d><84> <eb><a7><8c><ec><a1><b1><ed><95><b4><ec><95><bc> <ed><95><98><eb><a9><b0>, density<ec><9d><98> <ed><98><95><ed><83><9c><eb><a5><bc> <ec><9b><90><ec><a0><90><ec><97><90><ec><84><9c> <eb><8c><80><ec><b9><ad><ec><9c><bc><eb><a1><9c> <ec><a0><95><ec><9d><98><ed><95><9c><eb><8b><a4>.\n\n# kernel function <ec><a2><85><eb><a5><98>\n\n![](https://upload.wikimedia.org/wikipedia/commons/thumb/4/47/Kernels.svg/500px-Kernels.svg.png)\n\nkernel<ec><9d><98> <ed><98><95><ed><83><9c><eb><8a><94> <ec><a0><95><ec><9d><98><ed><95><98><ea><b8><b0><ec><97><90> <eb><94><b0><eb><9d><bc> <ec><97><ac><eb><9f><ac> <ec><a2><85><eb><a5><98><ea><b0><80> <ec><9e><88><eb><8b><a4>.\nkernel <ed><95><a8><ec><88><98><ec><9d><98> <ed><98><95><ed><83><9c><ec><97><90> <eb><94><b0><eb><9d><bc> <ec><b6><94><ec><a0><95><eb><90><98><eb><8a><94> <eb><b0><80><eb><8f><84><ec><9d><98> <ed><98><95><ed><83><9c><ea><b0><80> <ec><a1><b0><ea><b8><88><ec><94><a9> <eb><b0><94><eb><80><90><eb><8b><a4>.\n<eb><8b><a4><eb><a7><8c> <ec><a0><84><eb><b0><98><ec><a0><81><ec><9d><b8> <ec><b6><94><ec><a0><95><eb><90><9c> <eb><b0><80><eb><8f><84><ec><9d><98> <ed><98><95><ed><83><9c><eb><8a><94> <ea><b1><b0><ec><9d><98> <ec><9c><a0><ec><82><ac><ed><95><98><eb><8b><a4>(MISE<eb><a5><bc> <ea><b8><b0><ec><a4><80><ec><9c><bc><eb><a1><9c> kernel<eb><b3><84> <ec><a0><90><ea><b7><bc><ec><a0><81> <ec><83><81><eb><8c><80> <ed><9a><a8><ec><9c><a8><ec><84><b1><ec><9d><84> <eb><b9><84><ea><b5><90><ed><95><b4><eb><b3><b4><eb><a9><b4> Epanechnikov kernel<ec><9d><b4> 1<eb><a1><9c> <ea><b0><80><ec><9e><a5> <ec><a2><8b><ec><a7><80><eb><a7><8c> <eb><8b><a4><eb><a5><b8> kernel function<ea><b3><bc> <ed><81><b0> <ec><b0><a8><ec><9d><b4><eb><a5><bc> <eb><b3><b4><ec><9d><b4><ec><a7><80> <ec><95><8a><eb><8a><94><eb><8b><a4>).\n\nkernel function<ec><9d><84> <ec><a0><95><ed><95><98><eb><8a><94> <ea><b2><83> <eb><b3><b4><eb><8b><a4><eb><8a><94> bin width<eb><a5><bc> <ec><a0><95><ed><95><98><eb><8a><94> <ea><b2><83><ec><9d><b4> <eb><8d><94> <ec><a4><91><ec><9a><94><ed><95><98><eb><8b><a4>.\nrectangular kernel<ec><9d><bc> <ea><b2><bd><ec><9a><b0> histogram density estimation<ea><b3><bc> <ea><b0><99><eb><8b><a4>.\n\n## Gaussian kernel example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(65, 75, 67, 79, 81, 91) # observed data \ny <- 50:99  \nh <- 5.5\nn <- length(y)\n\nB <- numeric(n)\nK <- numeric(n)\n```\n:::\n\n\n### $x_i$ = 65<ec><9d><bc> <eb><95><8c>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (j in 1:n) {\n        A <- 1/(h*sqrt(2*pi))\n        B[j] <- (-0.5)*((y[j] - 65)/h)^2\n        K[j] <- A*exp(B[j])\n}\n\nplot(y, K, type = 'l', main = 'kernel at xi = 65')\n```\n\n::: {.cell-output-display}\n![](KDE_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n### <ea><b0><81> $x_i$ <eb><b3><84> kernel plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- length(x)\n\nB <- matrix(0, nrow = n, ncol = m)\nK <- matrix(0, nrow = n, ncol = m)\n\nfor (i in 1:m) {\n        for (j in 1:n) {\n                A <- 1/(h*sqrt(2*pi)*m)\n                B[j, i] <- (-0.5)*((y[j] - x[i])/h)^2\n                K[j, i] <- A*exp(B[j, i])\n        }\n}\n\n\n\nplot(y, K[,1], type = 'l', main = '', xlim = c(45, 110), ylim = c(0, 0.04))\nfor (i in 2:6) {\n        lines(y, K[,i], type = 'l', main = '')\n}\n\n\n# <ec><b5><9c><ec><a2><85> kernel\nK <- round(K, digit = 7)\nd <- rowSums(K)\n\nlines(y, d, type = 'l', main = 'Kernel density')\n```\n\n::: {.cell-output-display}\n![](KDE_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### $h$ <ea><b0><92><ec><97><90> <eb><94><b0><eb><a5><b8> kernel<ec><9d><98> <ed><98><95><ed><83><9c> <eb><b3><80><ed><99><94> (Gaussian kernel <ec><9d><bc> <eb><95><8c>)\n\n$h$ <ea><b0><92><ec><9d><84> <ec><9e><91><ea><b2><8c> <ed><95><98><eb><a9><b4> undersmooth<eb><90><98><ea><b3><a0>, <eb><b0><98><eb><a9><b4><ec><97><90> h<ea><b0><92><ec><9d><84> <ed><81><ac><ea><b2><8c> <ed><95><98><eb><a9><b4> oversmooth<eb><90><9c><eb><8b><a4>.\n<eb><94><b0><eb><9d><bc><ec><84><9c> <ec><a0><81><ec><a0><88><ed><95><9c> $h$<eb><a5><bc> <ec><b0><be><eb><8a><94> <ea><b2><83><ec><9d><b4> <ec><a4><91><ec><9a><94><ed><95><98><eb><8b><a4>.\n$h$ <ea><b0><92><ec><9d><80> MLCV(Maximum likelihood cross validation)<ec><97><90> <ec><9d><98><ed><95><b4> <ec><b6><94><ec><a0><95><ed><95><a0> <ec><88><98> <ec><9e><88><eb><8b><a4>.\n$MLCV_{max} = \\frac{1}{n}\\sum_{i=1}^nlog[\\sum_{j}w(\\frac{x_j-X_i}{h})]-log[(n-1)h]$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(-0.77, -0.6, -0.25, 0.14, 0.45, 0.64, 0.65, 1.19, 1.71, 1.74)\ny <- seq(-4, 4, 0.1)\nn <- NROW(x)\nm <- NROW(y)\n\nB <- matrix(0, nrow = m, ncol = n)\nK <- matrix(0, nrow = m, ncol = n)\n\nh <- 0.25\n\n\nfor (i in 1:n) {\n        for (j in 1:m) {\n                A <- 1/(h*sqrt(2*pi)*n)\n                B[j, i] <- (-1/2)*((y[j] - x[i])/h)^2\n                K[j, i] <- A*exp(B[j, i])\n        }\n}\n\nplot(y, K[,1], type = 'l', main = 'h = 0.25', ylim = c(0, 0.55), ylab = '', xlab = '')\nfor (i in 2:10) {\n        lines(y, K[,i], type = 'l', main = '')\n}\n\n\nK <- round(K, digit = 7)\nd <- rowSums(K)\nlines(y, d, type = 'l', main = '')\n```\n\n::: {.cell-output-display}\n![](KDE_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nx <- c(-0.77, -0.6, -0.25, 0.14, 0.45, 0.64, 0.65, 1.19, 1.71, 1.74)\ny <- seq(-4, 4, 0.1)\nn <- NROW(x)\nm <- NROW(y)\n\nB <- matrix(0, nrow = m, ncol = n)\nK <- matrix(0, nrow = m, ncol = n)\n\nh <- 1\n\n\nfor (i in 1:n) {\n        for (j in 1:m) {\n                A <- 1/(h*sqrt(2*pi)*n)\n                B[j, i] <- (-1/2)*((y[j] - x[i])/h)^2\n                K[j, i] <- A*exp(B[j, i])\n        }\n}\n\nplot(y, K[,1], type = 'l', main = 'h = 1', ylim = c(0, 0.55), ylab = '', xlab = '')\nfor (i in 2:10) {\n        lines(y, K[,i], type = 'l', main = '')\n}\n\n\nK <- round(K, digit = 7)\nd <- rowSums(K)\nlines(y, d, type = 'l', main = '')\n```\n\n::: {.cell-output-display}\n![](KDE_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\n# Boundary kernel\n\n<ec><9b><90><ec><a0><90><ec><97><90><ec><84><9c> <eb><b6><88><ec><97><b0><ec><86><8d><ec><a0><90><ec><9d><b4> <ec><a1><b4><ec><9e><ac><ed><95><98><ea><b1><b0><eb><82><98> $x$<ec><9d><98> <eb><b2><94><ec><9c><84><ea><b0><80> <ec><9b><90><ec><a0><90><ec><97><90><ec><84><9c> <ec><8b><9c><ec><9e><91><ed><95><98><ea><b1><b0><eb><82><98> <eb><81><9d><eb><82><98><eb><8a><94> <ea><b2><bd><ec><9a><b0>(boundary of the support set of a density) <ec><a6><89>, boundary <ec><a3><bc><eb><b3><80><ec><97><90><ec><84><9c> KDE<eb><8a><94> large error<eb><a5><bc> <ea><b0><96><eb><8a><94><eb><8b><a4>.\n<ec><9d><b4><ec><97><90> <eb><8c><80><ed><95><9c> <ed><95><b4><ea><b2><b0><ec><b1><85><ec><9c><bc><eb><a1><9c> reflection boundary technique<ec><9d><84> <ea><b3><a0><eb><a0><a4><ed><95><b4><eb><b3><bc> <ec><88><98> <ec><9e><88><eb><8b><a4>.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nx <- rexp(1000, 1)\nplot(density(x), xlim = c(-1, 6), ylim = c(0, 1), main = '')\nabline(v = 0)\n\ny <- seq(0.001, 6, 0.01)\nlines(y, dexp(y, 1), lty = 2)\n```\n\n::: {.cell-output-display}\n![](KDE_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n# Reflection boundary technique\n\n<ec><a0><84><ec><b2><b4> <eb><8d><b0><ec><9d><b4><ed><84><b0> $x_1, ..., x_n$<ec><97><90> <eb><8c><80><ed><95><b4><ec><84><9c> <ec><9b><90><ec><a0><90><ec><97><90><ec><84><9c> <eb><8c><80><ec><b9><ad><ec><9d><b8> $-x_1, ..., -x_n$<ec><9d><84> <eb><a7><8c><eb><93><a0><eb><8b><a4>.\n$2n$<ea><b0><9c><ec><9d><98> <eb><8d><b0><ec><9d><b4><ed><84><b0><eb><a5><bc> <ec><9d><b4><ec><9a><a9><ed><95><b4><ec><84><9c> $g$<eb><a5><bc> <ec><b6><94><ec><a0><95><ed><95><9c><eb><8b><a4>.\n$\\hat{f(x)}=2\\hat{g(x)}$ <br> <ec><a6><89>, <eb><8c><80><ec><b9><ad><ec><9d><b8> 2<ea><b0><9c><ec><9d><98> <eb><8d><b0><ec><9d><b4><ed><84><b0><ec><85><8b><ec><97><90> <eb><8c><80><ed><95><b4><ec><84><9c> <ea><b0><81><ea><b0><81> KDE<eb><a5><bc> <ea><b5><ac><ed><95><9c><eb><8b><a4>.\n<eb><91><90> <ea><b0><9c><ec><9d><98> KDE<eb><a5><bc> <ed><95><a9><ed><95><9c> KDE<eb><a5><bc> <ea><b5><ac><ed><95><98><ea><b3><a0> <ec><9b><90> <eb><8d><b0><ec><9d><b4><ed><84><b0> <eb><b2><94><ec><9c><84><ec><9d><98> KDE<eb><a7><8c> <eb><82><a8><ea><b8><b4><eb><8b><a4>.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nx <- rexp(1000, 1)\nz=-x\nplot(density(x), xlim = c(-6, 6), ylim = c(0, 1), main = '', col = 'red')\nabline(v = 0)\n\ny <- seq(0.001, 6, 0.01)\nlines(density(z), xlim = c(-6, 6), ylim = c(0, 1), main = '', col = 'blue')\n\nxx <- c(x, -x)\ng <- density(xx, bw = bw.nrd0(x))\na <- seq(-6, 6, 0.01)\nghat <- approx(g$x, g$y, xout = a) # <ec><a7><80><ec><a0><95><eb><90><9c> <ec><88><98><ec><9d><98> <ea><b7><bc><ec><82><ac> <ed><95><a8><ec><88><98> <ea><b0><92><ec><9d><84> <eb><b0><98><ed><99><98> \nfhat <- 2*ghat$y\n\nbw <- paste('Bandwidth = ', round(g$bw, 5))\nlines(a, fhat, type = 'l', xlim = c(-6, 6), ylim = c(0, 1), main = '', xlab = bw, ylab = 'density')\nabline(v=0)\n\ny <- seq(0.001, 6, 0.01)\nlines(y, dexp(y, 1), lty = 2)\n```\n\n::: {.cell-output-display}\n![](KDE_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n<ec><b0><b8><ea><b3><a0> 1 : <https://medium.com/analytics-vidhya/kernel-density-estimation-kernel-construction-and-bandwidth-optimization-using-maximum-b1dfce127073>\n\n<ec><b0><b8><ea><b3><a0> 2 : statistical computing with R second edition\n",
    "supporting": [
      "KDE_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}